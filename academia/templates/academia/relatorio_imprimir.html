<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Alunos</title>
    <style>
        body { font-family: sans-serif; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #eee; }
        .header { text-align: center; margin-bottom: 30px; }
        @media print {
            .no-print { display: none; }
        }
    </style>
</head>
<body onload="window.print()"> <div class="no-print" style="padding: 10px; background: #eee; text-align: center;">
        <a href="{% url 'gerar_relatorio_alunos' %}" style="font-size: 14px;">← Voltar para Filtros</a>
    </div>

    <div class="header">
        <h1>Relatório de Alunos - Projeto Semear</h1>
        <p>Gerado em: {% now "d/m/Y H:i" %}</p>
    </div>

    <table>
        <thead>
            <tr>
                {% if form.cleaned_data.mostrar_foto %} <th>Foto</th> {% endif %}
                <th>Nome</th>
                {% if form.cleaned_data.mostrar_telefone %} <th>Telefone</th> {% endif %}
                {% if form.cleaned_data.mostrar_nascimento %} <th>Nascimento</th> {% endif %}
                {% if form.cleaned_data.mostrar_endereco %} <th>Endereço</th> {% endif %}
                {% if form.cleaned_data.mostrar_responsavel %} <th>Responsável</th> {% endif %}
                {% if form.cleaned_data.mostrar_igreja %} <th>Igreja</th> {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for aluno in alunos %}
            <tr>
                {% if form.cleaned_data.mostrar_foto %}
                    <td>
                        {% if aluno.foto %}
                            <img src="{{ aluno.foto.url }}" width="40" height="40" style="object-fit: cover; border-radius: 50%;">
                        {% endif %}
                    </td>
                {% endif %}
                
                <td><strong>{{ aluno.user.username }}</strong></td>
                
                {% if form.cleaned_data.mostrar_telefone %} <td>{{ aluno.telefone }}</td> {% endif %}
                
                {% if form.cleaned_data.mostrar_nascimento %} 
                    <td>{{ aluno.data_nascimento|date:"d/m/Y"|default:"-" }}</td> 
                {% endif %}
                
                {% if form.cleaned_data.mostrar_endereco %} <td>{{ aluno.endereco|default:"-" }}</td> {% endif %}
                
                {% if form.cleaned_data.mostrar_responsavel %} 
                    <td>{{ aluno.nome_responsavel|default:"-" }}</td> 
                {% endif %}
                
                {% if form.cleaned_data.mostrar_igreja %} 
                    <td>
                        {% if aluno.membro_metodista %}Metodista{% else %}{{ aluno.outra_igreja }}{% endif %}
                    </td> 
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>