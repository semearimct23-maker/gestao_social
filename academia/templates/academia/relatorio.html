{% extends 'base.html' %}

{% block title %}Relatório de Frequência{% endblock %}

{% block content %}
    <h1>Relatório: {{ curso.nome }}</h1>
    <p>Histórico completo de chamadas.</p>

    <p><a href="{% url 'dashboard_professor' %}">← Voltar para o Dashboard</a></p>
    <hr>

    {% if not presencas %}
        <p>Nenhuma chamada realizada neste curso ainda.</p>
    {% else %}
<div style="background-color: #f9f9f9; padding: 15px; border-radius: 8px; margin: 20px 0;">
        <form method="GET" style="display: flex; gap: 10px; align-items: center;">
            <strong>Filtrar Período:</strong>
            
            <select name="mes" style="padding: 5px;">
                <option value="1" {% if mes_atual == 1 %}selected{% endif %}>Janeiro</option>
                <option value="2" {% if mes_atual == 2 %}selected{% endif %}>Fevereiro</option>
                <option value="3" {% if mes_atual == 3 %}selected{% endif %}>Março</option>
                <option value="4" {% if mes_atual == 4 %}selected{% endif %}>Abril</option>
                <option value="5" {% if mes_atual == 5 %}selected{% endif %}>Maio</option>
                <option value="6" {% if mes_atual == 6 %}selected{% endif %}>Junho</option>
                <option value="7" {% if mes_atual == 7 %}selected{% endif %}>Julho</option>
                <option value="8" {% if mes_atual == 8 %}selected{% endif %}>Agosto</option>
                <option value="9" {% if mes_atual == 9 %}selected{% endif %}>Setembro</option>
                <option value="10" {% if mes_atual == 10 %}selected{% endif %}>Outubro</option>
                <option value="11" {% if mes_atual == 11 %}selected{% endif %}>Novembro</option>
                <option value="12" {% if mes_atual == 12 %}selected{% endif %}>Dezembro</option>
            </select>

            <select name="ano" style="padding: 5px;">
                <option value="2024" {% if ano_atual == 2024 %}selected{% endif %}>2024</option>
                <option value="2025" {% if ano_atual == 2025 %}selected{% endif %}>2025</option>
                <option value="2026" {% if ano_atual == 2026 %}selected{% endif %}>2026</option>
            </select>

            <button type="submit" style="background-color: #3498db; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                Filtrar
            </button>
        </form>
    </div>
    
    <p>Exibindo registros de: <strong>{{ mes_atual }}/{{ ano_atual }}</strong></p>
        <table border="1" cellpadding="10" style="border-collapse: collapse; width: 100%;">
            <thead style="background-color: #eee;">
                <tr>
                    <th>Data</th>
                    <th>Aluno</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for p in presencas %}
                    <tr>
                        <td>{{ p.data_aula|date:"d/m/Y" }}</td>
                        <td>{{ p.aluno.user.username }}</td>
                        <td>
                            {% if p.presente %}
                                <span style="color: green; font-weight: bold;">PRESENTE</span>
                            {% else %}
                                <span style="color: red; font-weight: bold;">FALTA</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

{% endblock %}